function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}const axios=require('axios'),qs=require('qs'),{createJobUrl}=require('./helpers');class Jenkins{constructor(a,b,c,d={}){this.token=b,this.baseUrl=`http://${a}:${b}@${c}`,this.urlParams={token:b},this.headers=Object.assign({},{Authorization:this.urlParams.token},d),this.crumb=null}info(){var a=this;return _asyncToGenerator(function*(){const[b,c]=yield a._getRequest('/api/json'),d=yield axios.get(b,c);return d.data})()}getJobInfo(a){var b=this;return _asyncToGenerator(function*(){const[c,d]=yield b._getRequest(a,!0);try{const a=yield axios.get(c,d);return a.data}catch(a){return a.statusText}})()}getBuildInfo(a,b){var c=this;return _asyncToGenerator(function*(){const[d,e]=yield c._getRequest(a,!0,`/${b}`);try{const a=yield axios.get(d,e);return a.data}catch(a){return a.statusText}})()}_getCrumb(){var a=this;return _asyncToGenerator(function*(){const b=`${a.baseUrl}/crumbIssuer/api/json`;try{const c=yield axios.get(b,a.headers),d=c.data;return a.crumb=d,d}catch(a){return a.statusText}})()}_getRequest(a,b=!1,c=''){var d=this;return _asyncToGenerator(function*(){a=a.startsWith('/')?a:`/${a}`;const e=`${d.baseUrl}${b?`${createJobUrl(a)}${c}/api/json`:a}`,f=d.crumb||(yield d._getCrumb()),g=Object.assign({},d.headers,{[f.crumbRequestField]:f.crumb});return[`${e}?${qs.stringify(d.urlParams)}`,{headers:g}]})()}toString(){return`<Jenkins ${this.token}>`}}module.exports=Jenkins;
